{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the Hagaaty AI Blog.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "username": {
          "type": "string",
          "description": "User's chosen username."
        },
        "favoriteArticleIds": {
          "type": "array",
          "description": "References to Articles favorited by the User. (Relationship: User 1:N Article - Favorites)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "email",
        "username"
      ]
    },
    "Article": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Article",
      "type": "object",
      "description": "Represents a blog article generated or created within the Hagaaty AI Blog.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Article entity."
        },
        "title": {
          "type": "string",
          "description": "Title of the article."
        },
        "content": {
          "type": "string",
          "description": "The main content of the article (likely HTML or Markdown)."
        },
        "authorId": {
          "type": "string",
          "description": "Reference to User who created the article. (Relationship: User 1:N Article - Creation)"
        },
        "categoryId": {
          "type": "string",
          "description": "Reference to Category the article belongs to. (Relationship: Category 1:N Article)"
        },
        "tagIds": {
          "type": "array",
          "description": "References to Tags associated with the article. (Relationship: Tag N:N Article)",
          "items": {
            "type": "string"
          }
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the article was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp indicating when the article was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "title",
        "content",
        "authorId",
        "categoryId",
        "createdAt",
        "updatedAt"
      ]
    },
    "Category": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Category",
      "type": "object",
      "description": "Represents a category for organizing blog articles.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Category entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the category."
        },
        "description": {
          "type": "string",
          "description": "Description of the category."
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "Tag": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Tag",
      "type": "object",
      "description": "Represents a tag associated with blog articles.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Tag entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the tag."
        }
      },
      "required": [
        "id",
        "name"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles. Path-based ownership ensures only the authenticated user can access their own profile.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user, matching the Firebase Auth UID."
            }
          ]
        }
      },
      {
        "path": "/articles/{articleId}",
        "definition": {
          "entityName": "Article",
          "schema": {
            "$ref": "#/backend/entities/Article"
          },
          "description": "Stores blog articles. Includes 'authorId' for authorization. This denormalization enables querying articles by author and simplifies security rules.",
          "params": [
            {
              "name": "articleId",
              "description": "The unique identifier of the article."
            }
          ]
        }
      },
      {
        "path": "/categories/{categoryId}",
        "definition": {
          "entityName": "Category",
          "schema": {
            "$ref": "#/backend/entities/Category"
          },
          "description": "Stores categories for articles. Accessible to all users for reading.",
          "params": [
            {
              "name": "categoryId",
              "description": "The unique identifier of the category."
            }
          ]
        }
      },
      {
        "path": "/tags/{tagId}",
        "definition": {
          "entityName": "Tag",
          "schema": {
            "$ref": "#/backend/entities/Tag"
          },
          "description": "Stores tags for articles. Accessible to all users for reading.",
          "params": [
            {
              "name": "tagId",
              "description": "The unique identifier of the tag."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/favorites/{articleId}",
        "definition": {
          "entityName": "Favorite",
          "schema": {
            "$ref": "#/backend/entities/Article"
          },
          "description": "Stores references to articles favorited by the user. Path-based ownership ensures only the authenticated user can manage their own favorites.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user, matching the Firebase Auth UID."
            },
            {
              "name": "articleId",
              "description": "The unique identifier of the article (only storing IDs, to reference data in 'articles')."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to optimize for security, scalability, and maintainability, adhering to the principles of Authorization Independence, Structural Segregation, and Access Modeling. User data is stored in a path-based ownership model under `/users/{userId}`. Articles are stored in a top-level `/articles` collection, with the author's ID denormalized into each article document to facilitate direct querying and authorization. Categories and Tags are stored in their respective top-level collections for global access. Favorite articles are handled as a subcollection `/users/{userId}/favorites/{articleId}` where access is controlled at the path level. This structure ensures that authorization rules do not require `get()` calls to parent documents, enabling atomic operations. The QAP is achieved by direct document access and query capabilities within each collection, avoiding the need for complex filtering rules. The Category and Tag entities are stored in root level collections for ease of retrieval and global association."
  }
}